---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: '{{ include "name" . }}-minio'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-minio.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-minio'
          port: http
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/group: Data
    gethomepage.dev/icon: sh-minio
    gethomepage.dev/name: Minio
    gethomepage.dev/pod-selector: app=minio
    gethomepage.dev/href: https://data-minio-console.{{ .Values.gateway_hostname }}/login
  name: '{{ include "name" . }}-minio-console'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-minio-console.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-minio-console'
          port: http
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Airflow"
    gethomepage.dev/pod-selector: "component=api-server,tier=airflow"
    gethomepage.dev/group: "Data"
    gethomepage.dev/icon: "si-apacheairflow"
    gethomepage.dev/href: "https://data-airflow.{{ .Values.gateway_hostname }}"
  name: '{{ include "name" . }}-airflow-api-server'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-airflow.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-airflow-api-server'
          port: api-server
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Nessie"
    gethomepage.dev/pod-selector: "app.kubernetes.io/name=nessie"
    gethomepage.dev/group: "Data"
    gethomepage.dev/icon: "https://projectnessie.org/img/nessie.svg"
    gethomepage.dev/href: "https://data-nessie.{{ .Values.gateway_hostname }}"
  name: '{{ include "name" . }}-nessie'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-nessie.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-nessie'
          port: nessie-http
      middlewares:
        - name: oauth2-proxy-auth
          namespace: security
    - match: Host(`data-nessie.{{ .Values.gateway_hostname }}`) && PathPrefix(`/oauth2/`)
      kind: Rule
      services:
        - name: oauth2-proxy
          namespace: security
          port: http
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Redpanda Console"
    gethomepage.dev/pod-selector: "app.kubernetes.io/name=redpanda"
    gethomepage.dev/group: "Data"
    gethomepage.dev/icon: "https://raw.githubusercontent.com/redpanda-data/console/refs/heads/master/frontend/src/assets/logos/redpanda-icon-color.svg"
    gethomepage.dev/href: "https://data-redpanda-console.{{ .Values.gateway_hostname }}"
  name: '{{ include "name" . }}-redpanda-console'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-redpanda-console.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-redpanda-console'
          port: http
      middlewares:
        - name: oauth2-proxy-auth
          namespace: security
    - match: Host(`data-redpanda-console.{{ .Values.gateway_hostname }}`) && PathPrefix(`/oauth2/`)
      kind: Rule
      services:
        - name: oauth2-proxy
          namespace: security
          port: http
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Superset"
    gethomepage.dev/pod-selector: "app=superset"
    gethomepage.dev/group: "Data"
    gethomepage.dev/icon: "https://superset.apache.org/img/superset-mark-dark.svg"
    gethomepage.dev/href: "https://data-superset.{{ .Values.gateway_hostname }}"
  name: '{{ include "name" . }}-superset'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-superset.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-superset'
          port: http
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Trino"
    gethomepage.dev/pod-selector: "app.kubernetes.io/name=trino"
    gethomepage.dev/group: "Data"
    gethomepage.dev/icon: "https://trino.io/docs/current/_static/trino.svg"
    gethomepage.dev/href: "https://data-trino.{{ .Values.gateway_hostname }}/ui/"
  name: '{{ include "name" . }}-trino'
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`data-trino.{{ .Values.gateway_hostname }}`)
      kind: Rule
      services:
        - name: '{{ include "name" . }}-trino-trino'
          port: http
      middlewares:
        - name: oauth2-proxy-auth
          namespace: security
    - match: Host(`data-trino.{{ .Values.gateway_hostname }}`) && PathPrefix(`/oauth2/`)
      kind: Rule
      services:
        - name: oauth2-proxy
          namespace: security
          port: http
