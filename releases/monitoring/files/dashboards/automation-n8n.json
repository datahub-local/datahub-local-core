{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 204,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 0,
        "y": 0
      },
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "limit": 1,
          "values": true
        },
        "showPercentChange": false,
        "textMode": "name",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "builder",
          "expr": "n8n_version_info",
          "legendFormat": "{{version}}",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "n8n Version",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Time": "${__field.labels.version}",
              "n8n_version_info{instance=\"n8n:5678\", job=\"n8n\", major=\"1\", minor=\"91\", patch=\"3\", version=\"v1.91.3\"}": "${__field.labels.version}"
            }
          }
        }
      ],
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 4,
        "y": 0
      },
      "id": 1,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "exemplar": false,
          "expr": "label_replace(n8n_active_workflow_count, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "instant": false,
          "interval": "",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "A",
          "useBackend": false
        }
      ],
      "title": "Active Workflows",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 0
      },
      "id": 9,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_process_open_fds, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "interval": "",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "O",
          "useBackend": false
        }
      ],
      "title": "Open File Descriptors",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays the actual physical memory (RAM) used by the n8n process (Resident Set Size).\nThis is the most critical indicator of real memory pressure on the host.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 12,
        "y": 0
      },
      "id": 16,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_process_resident_memory_bytes, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "A",
          "useBackend": false
        }
      ],
      "title": "Resident Memory Usage (RSS)",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Shows the total count of all active libuv handles currently managed by Node.js.\nHigh or increasing values over time might suggest resource exhaustion or unexpected behavior in your application.",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 0
      },
      "id": 14,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_nodejs_active_handles_total, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "T",
          "useBackend": false
        }
      ],
      "title": "Total Active Handles",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 20,
        "y": 0
      },
      "id": 13,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_nodejs_active_resources_total, \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "S",
          "useBackend": false
        }
      ],
      "title": "Total Active Resources",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 0,
        "y": 4
      },
      "id": 15,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "limit": 1,
          "values": true
        },
        "showPercentChange": false,
        "textMode": "name",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "n8n_nodejs_version_info",
          "legendFormat": "{{major}}.{{minor}}",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "n8n nodejs version info",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {},
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Time": "${__field.labels.version}",
              "n8n_nodejs_version_info{instance=\"n8n:5678\", job=\"n8n\", major=\"20\", minor=\"19\", patch=\"0\", version=\"v20.19.0\"}": "${__field.labels.version}",
              "n8n_version_info{instance=\"n8n:5678\", job=\"n8n\", major=\"1\", minor=\"91\", patch=\"3\", version=\"v1.91.3\"}": "${__field.labels.version}"
            }
          }
        }
      ],
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 4
      },
      "id": 10,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_process_max_fds, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "P",
          "useBackend": false
        }
      ],
      "title": "Max File Descriptors",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Shows the current event loop lag in seconds.\n\nThis value reflects the real-time delay in the Node.js event loop.  \nA consistently high value suggests the system is struggling to process events timely, possibly due to heavy synchronous tasks or CPU bottlenecks.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 0.01
              },
              {
                "color": "#EAB839",
                "value": 0.05
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 4
      },
      "id": 17,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_nodejs_eventloop_lag_seconds, \"server_type\", \"n8n$1\", \"job\", \".+-n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "A",
          "useBackend": false
        }
      ],
      "title": "Current Event Loop Lag",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays the Total CPU usage (user + system) of the n8n process over time.\n\nUses the Prometheus metric n8n_process_cpu_seconds_total with rate() over 5 minutes to show the CPU consumption rate per second.\n\nValues are shown as CPU seconds used per second, which is automatically formatted in milliseconds (ms) for readability.\n\nInterpretation:\n\n1 s/s = 100% of a single core\n\n0.5 s/s = 50% of a single core\n\n0.01 s/s = 1% of a single core\n\nThis visualization does NOT adjust for the number of CPU cores; it's raw usage on a single-core equivalent.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 24,
        "x": 0,
        "y": 8
      },
      "id": 3,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_process_cpu_seconds_total[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "C",
          "useBackend": false
        }
      ],
      "title": "Total CPU Usage (User + System) Rate 5m",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Shows the Resident Memory (RSS) and Virtual Memory of the n8n process over time.\n- Resident Memory (Green): Actual physical RAM used by the process.\n- Virtual Memory (Yellow): Total allocated address space (can be much larger than physical usage).\nUnit: IEC (GiB, MiB) to match OS-level memory reporting.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 24,
        "x": 0,
        "y": 13
      },
      "id": 4,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_process_resident_memory_bytes, \"server_type\", \"n8n$1-resident\", \"job\", \".+n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "D",
          "useBackend": false
        },
        {
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "label_replace(n8n_process_virtual_memory_bytes, \"server_type\", \"n8n$1-virtual\", \"job\", \".+n8n(.*)\")",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "E",
          "useBackend": false
        }
      ],
      "title": "Resident vs Virtual Memory",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays the Event Loop Lag over time using three key metrics:\n- **Mean (average):** The average delay of the event loop over the collection window.\n- **Max:** The maximum recorded delay, showing peak lag spikes.\n- **P99:** The 99th percentile, indicating the worst lag observed for 99% of the time.\n\nThese metrics help detect event loop blocking patterns, monitor performance trends, and identify rare but impactful latency spikes.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 24,
        "x": 0,
        "y": 17
      },
      "id": 5,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_eventloop_lag_mean_seconds, \"server_type\", \"n8n$1-mean\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "F"
        },
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_eventloop_lag_max_seconds, \"server_type\", \"n8n$1-max\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "G"
        },
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_eventloop_lag_p99_seconds, \"server_type\", \"n8n$1-p99\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "H"
        }
      ],
      "title": "Event Loop Lag - Mean, Max, P99",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Description:\nTracks the Node.js heap memory usage over time.\n\nUsed Heap: Actual memory used for objects.\n\nTotal Heap: Allocated heap limit.\nMemory is reported in bytes and auto-scaled (MB, GB) for readability.\nA sudden increase in total heap may indicate memory pressure, increased load, or recent workload spikes.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 24,
        "x": 0,
        "y": 22
      },
      "id": 6,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_heap_size_used_bytes, \"server_type\", \"n8n$1-used\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "I"
        },
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_heap_size_total_bytes, \"server_type\", \"n8n$1-total\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}",
          "range": true,
          "refId": "J"
        }
      ],
      "title": "Heap Usage - Used vs Total",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays Node.js heap space memory usage broken down by space type.\nShows memory consumption in each segment like 'old', 'new', 'large object', 'code', and others.\nHelps identify inefficient memory usage or potential memory leaks in specific heap spaces.\n",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 27
      },
      "id": 7,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(n8n_nodejs_heap_space_size_used_bytes, \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{space}}",
          "range": true,
          "refId": "K"
        }
      ],
      "title": "Heap Space Usage by Type",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays the average time spent in Garbage Collection (GC) over the past 5 minutes, broken down by type (minor, major, incremental).\nThe values are calculated as rate over time (rate()), giving the average GC pause time per second in the selected time range.\n\nMinor GC: Quick cleanup of short-lived objects (frequent, low duration).\n\nMajor GC: Full heap cleanup of long-lived objects (rare, high impact).\n\nIncremental GC: Partial cleanup to reduce long pauses (intermediate).\n\nThis panel helps monitor how much of your Node.js process time is being spent in GC activity and highlights GC pressure trends over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 35
      },
      "id": 8,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"minor\"}[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{kind}}",
          "range": true,
          "refId": "L"
        },
        {
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"major\"}[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{kind}}",
          "range": true,
          "refId": "M"
        },
        {
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_nodejs_gc_duration_seconds_sum{kind=\"incremental\"}[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{kind}}",
          "range": true,
          "refId": "N"
        }
      ],
      "title": "GC Duration (Minor, Major, Incremental) - Rate over 5m",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Displays the current number of active Node.js libuv handles grouped by type (e.g., Socket, Server).\n\nEach handle type represents an underlying C++ class (e.g., TCP Socket, Timer, Pipe).\n\nThis can help diagnose resource leaks, stalled connections, or unexpected handle growth over time.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 43
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_nodejs_active_handles[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{type}}",
          "range": true,
          "refId": "Q"
        }
      ],
      "title": "Active Handles by Type",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Shows the current number of active asynchronous resources that are keeping the Node.js event loop alive, grouped by resource type (e.g., PipeWrap, TCPSocketWrap, Timeout).\nThese represent internal Node.js resources tied to async operations like timers, sockets, and pipes.\nAn unexpected increase or steady accumulation of certain resource types may indicate stuck or inefficient asynchronous code (e.g., open sockets not closing, long-running timers).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 51
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.0.0",
      "targets": [
        {
          "editorMode": "code",
          "expr": "label_replace(rate(n8n_nodejs_active_resources[5m]), \"server_type\", \"n8n$1\", \"job\", \".+n8n(.*)\")",
          "legendFormat": "{{server_type}}-{{type}}",
          "range": true,
          "refId": "R"
        }
      ],
      "title": "Active Resources by Type",
      "type": "timeseries"
    }
  ],
  "preload": false,
  "schemaVersion": 41,
  "tags": [],
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "Homelab / Automation / n8n",
  "uid": "464e0aa6-c0ad-4e01-bb92-8ceaf2638ceb",
  "version": 1
}